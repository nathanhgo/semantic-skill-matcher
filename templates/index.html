<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Semantic Skill Matcher</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #121212; color: #e0e0e0; font-family: 'Segoe UI', sans-serif; }
        .card { background-color: #1e1e1e; border: 1px solid #333; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        .form-control { background-color: #2c2c2c; border: 1px solid #444; color: white; }
        .form-control:focus { background-color: #333; color: white; border-color: #0d6efd; }
        
        /* SKILLS: Layout Linear e Limpo */
        .skill-item {
            margin-bottom: 15px;
            padding: 10px;
            border-bottom: 1px solid #2c2c2c;
        }
        .skill-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        .skill-name { font-weight: 600; color: #fff; font-size: 1.05rem; }
        .skill-percent { font-weight: bold; font-family: monospace; }
        
        .progress {
            height: 10px; /* Barra fina e elegante */
            background-color: #2c2c2c;
            border-radius: 5px;
        }

        /* ISCO: Contexto */
        .isco-box { background: #252525; border-left: 4px solid #0d6efd; padding: 12px; margin-bottom: 15px; border-radius: 0 4px 4px 0;}
        .isco-tree { font-size: 0.85rem; color: #aaa; margin-top: 5px; }
        .isco-sep { color: #555; margin: 0 5px; }
        .isco-highlight { color: #fff; font-weight: bold; }
        
        /* Cores de Texto baseadas no Bootstrap */
        .text-success-custom { color: #2ecc71; }
        .text-warning-custom { color: #f1c40f; }
        .text-danger-custom { color: #e74c3c; }
    </style>
</head>
<body>

<div class="container mt-5 pb-5">
    <h1 class="text-center mb-4 display-6 fw-bold">Semantic Skill Matcher</h1>

    <div class="card p-4 mb-5">
        <form method="POST" action="/">
            <label class="form-label text-light fw-bold">Perfil ou Descri√ß√£o:</label>
            <textarea class="form-control mb-3" name="skill_desc" rows="3" placeholder="Ex: Sou projetista de pain√©is el√©tricos...">{{ busca_anterior }}</textarea>
            <button type="submit" class="btn btn-primary w-100 fw-bold py-2">‚ö° Analisar Perfil Completo</button>
        </form>
    </div>

    {% if data.skills or data.occupations %}
    <div class="row">
        
        <div class="col-md-6 mb-4">
            <h4 class="text-white border-bottom border-warning pb-2 mb-4">
                üõ†Ô∏è Habilidades T√©cnicas
            </h4>
            
            <div class="card p-3">
                {% for skill in data.skills %}
                <div class="skill-item">
                    <div class="skill-header">
                        <span class="skill-name">{{ skill.termo }}</span>
                        <span class="skill-percent 
                            {% if skill.confianca > 75 %}text-success-custom
                            {% elif skill.confianca > 50 %}text-warning-custom
                            {% else %}text-danger-custom{% endif %}">
                            {{ skill.confianca }}%
                        </span>
                    </div>
                    <div class="progress">
                        <div class="progress-bar {{ skill.cor }}" role="progressbar" 
                             style="width: {{ skill.confianca }}%" 
                             aria-valuenow="{{ skill.confianca }}" aria-valuemin="0" aria-valuemax="100">
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <div class="col-md-6">
            <h4 class="text-white border-bottom border-primary pb-2 mb-4">
                üè≠ Cargo & Hierarquia
            </h4>
            
            {% for occ in data.occupations %}
            <div class="isco-box">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <h5 class="mb-0 text-primary fw-bold">{{ occ.termo }}</h5>
                    <span class="badge bg-dark border border-secondary">{{ occ.confianca }}%</span>
                </div>
                
                <div class="isco-tree">
                    {% for nivel in occ.arvore %}
                        {% if loop.last %}
                            <span class="isco-highlight">{{ nivel.label }}</span>
                        {% else %}
                            <span title="C√≥digo: {{ nivel.code }}">{{ nivel.label }}</span>
                            <span class="isco-sep">‚Ä∫</span>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
        </div>
        
    </div>
    {% endif %}

</div>
</body>
</html>